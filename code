import os

def get_latest_reports():
    # Корневая папка с отчетами
    network_folder = os.path.join("\\\\corp.suek.ru", "Share", "MSK_market_data", "market_data", "Market Reports")

    # Нам интересны только конечные папки с файлами
    folders_with_files = [
        (root, dirs, files)
        for (root, dirs, files) in os.walk(network_folder)
        if len(files) > 0
    ]

    # Словарь для хранения последних отчетов по типам
    latest_reports = {}

    for (root, dirs, files) in folders_with_files:
        # Извлечение типа отчета, года и месяца из структуры папок
        report_type = root.split(os.sep)[-3]
        report_year = root.split(os.sep)[-2]
        report_month = root.split(os.sep)[-1]

        # Проверяем актуальность
        set_this_as_best = False
        previous_best = latest_reports.get(report_type)

        if previous_best is None:
            # Это первый репорт такого типа
            set_this_as_best = True
        else:
            # Нужно понять новее ли эта итерация
            if (report_year > previous_best["year"]) or \
               ((report_year == previous_best["year"]) and (report_month > previous_best["month"])):
                set_this_as_best = True

        # Если поняли, что это лучший (или первый) вариант отчета
        if set_this_as_best:
            latest_reports[report_type] = {
                "year": report_year,
                "month": report_month,
                "files": [
                    os.path.join(root, file) for file in files
                ]
            }

    # Собираем все файлы в один список
    files_to_read = sum([v["files"] for _, v in latest_reports.items()], [])

    return files_to_read
